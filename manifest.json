{
  "$schema": "https://stina.app/schemas/extension-manifest.json",
  "id": "work-manager",
  "name": "Work Manager",
  "version": "0.0.6",
  "description": "Manage work todos and projects.",
  "type": "tools",
  "author": {
    "name": "Stina Team",
    "url": "https://github.com/einord"
  },
  "repository": "https://github.com/einord/stina-ext-work",
  "license": "MIT",
  "engines": {
    "stina": ">=0.7.1"
  },
  "platforms": ["web", "electron", "tui"],
  "main": "index.js",

  "permissions": [
    "tools.register",
    "events.emit",
    "database.own"
  ],

  "contributes": {
    "toolSettings": [
      {
        "id": "projects",
        "title": "Projects",
        "description": "Manage work projects.",
        "view": {
          "kind": "list",
          "listToolId": "work_projects_list",
          "getToolId": "work_projects_get",
          "upsertToolId": "work_projects_upsert",
          "deleteToolId": "work_projects_delete",
          "mapping": {
            "itemsKey": "projects",
            "countKey": "count",
            "idKey": "id",
            "labelKey": "name",
            "descriptionKey": "description"
          },
          "searchParam": "query",
          "limitParam": "limit",
          "idParam": "id"
        },
        "fields": [
          {
            "id": "name",
            "title": "Name",
            "type": "string",
            "validation": { "required": true }
          },
          {
            "id": "description",
            "title": "Description",
            "type": "string"
          }
        ]
      }
    ],
    "panels": [
      {
        "id": "work.todos",
        "title": "Work",
        "icon": "check-list",
        "view": {
          "kind": "grouped-list",
          "data": {
            "toolId": "work_panel_list",
            "resultKey": "groups",
            "refreshEvents": [
              "work.todos.updated",
              "work.projects.updated"
            ]
          },
          "group": {
            "idKey": "id",
            "titleKey": "title",
            "itemsKey": "items",
            "collapsedKey": "collapsed",
            "emptyLabel": "No todos"
          },
          "item": {
            "idKey": "id",
            "titleKey": "title",
            "descriptionKey": "description",
            "iconKey": "icon",
            "statusKey": "status",
            "dateKey": "date",
            "timeKey": "time",
            "commentCountKey": "commentCount",
            "comments": {
              "itemsKey": "comments",
              "textKey": "text",
              "createdAtKey": "createdAt"
            },
            "subItems": {
              "itemsKey": "subItems",
              "idKey": "id",
              "textKey": "text",
              "completedAtKey": "completedAt"
            }
          },
          "actions": {
            "toggleGroup": {
              "toolId": "work_panel_toggle_group",
              "params": {
                "groupId": { "ref": "group.id" },
                "collapsed": { "ref": "state.collapsed" }
              }
            },
            "toggleSubItem": {
              "toolId": "work_subitem_toggle",
              "params": {
                "todoId": { "ref": "item.id" },
                "subItemId": { "ref": "subItem.id" }
              }
            },
            "editItem": {
              "toolId": "work_todo_edit",
              "params": {
                "id": { "ref": "item.id" }
              }
            }
          },
          "editor": {
            "title": "Edit todo",
            "createLabel": "New todo",
            "getToolId": "work_todos_get",
            "upsertToolId": "work_todos_upsert",
            "deleteToolId": "work_todos_delete",
            "fields": [
              {
                "id": "title",
                "title": "Title",
                "type": "string",
                "validation": { "required": true }
              },
              {
                "id": "description",
                "title": "Description",
                "type": "string"
              },
              {
                "id": "icon",
                "title": "Icon",
                "type": "string",
                "default": "check-list",
                "validation": { "required": true }
              },
              {
                "id": "status",
                "title": "Status",
                "type": "select",
                "default": "not_started",
                "options": [
                  { "value": "not_started", "label": "Not started" },
                  { "value": "in_progress", "label": "In progress" },
                  { "value": "completed", "label": "Completed" },
                  { "value": "cancelled", "label": "Cancelled" }
                ]
              },
              {
                "id": "projectId",
                "title": "Project ID",
                "type": "string"
              },
              {
                "id": "dueAt",
                "title": "Due at (ISO 8601)",
                "type": "string",
                "validation": { "required": true }
              },
              {
                "id": "date",
                "title": "Date (YYYY-MM-DD)",
                "type": "string"
              },
              {
                "id": "time",
                "title": "Time (HH:MM)",
                "type": "string"
              },
              {
                "id": "allDay",
                "title": "All day",
                "type": "boolean",
                "default": false
              },
              {
                "id": "reminderMinutes",
                "title": "Reminder minutes",
                "type": "number"
              }
            ]
          }
        }
      }
    ],
    "tools": [
      {
        "id": "work_panel_list",
        "name": "List Work Panel",
        "description": "List todo groups for the work panel."
      },
      {
        "id": "work_panel_toggle_group",
        "name": "Toggle Work Group",
        "description": "Toggle collapsed state for a work group."
      },
      {
        "id": "work_subitem_toggle",
        "name": "Toggle Work Subitem",
        "description": "Toggle completion for a work todo subitem."
      },
      {
        "id": "work_todo_edit",
        "name": "Edit Work Todo",
        "description": "Open or update work todo details."
      },
      {
        "id": "work_projects_list",
        "name": "List Projects",
        "description": "List work projects."
      },
      {
        "id": "work_projects_get",
        "name": "Get Project",
        "description": "Get a project by ID."
      },
      {
        "id": "work_projects_upsert",
        "name": "Add/Update Project",
        "description": "Create or update a work project."
      },
      {
        "id": "work_projects_delete",
        "name": "Delete Project",
        "description": "Delete a project by ID."
      },
      {
        "id": "work_todos_list",
        "name": "List Todos",
        "description": "List todos with optional filters."
      },
      {
        "id": "work_todos_get",
        "name": "Get Todo",
        "description": "Get todo details by ID."
      },
      {
        "id": "work_todos_upsert",
        "name": "Add/Update Todo",
        "description": "Create or update a todo item."
      },
      {
        "id": "work_todos_delete",
        "name": "Delete Todo",
        "description": "Delete a todo by ID."
      },
      {
        "id": "work_comments_add",
        "name": "Add Comment",
        "description": "Add a comment to a todo."
      },
      {
        "id": "work_comments_delete",
        "name": "Delete Comment",
        "description": "Delete a comment from a todo."
      },
      {
        "id": "work_subitems_add",
        "name": "Add Subitem",
        "description": "Add a subitem to a todo."
      },
      {
        "id": "work_subitems_delete",
        "name": "Delete Subitem",
        "description": "Delete a subitem from a todo."
      },
      {
        "id": "work_settings_get",
        "name": "Get Work Settings",
        "description": "Get work extension settings."
      },
      {
        "id": "work_settings_update",
        "name": "Update Work Settings",
        "description": "Update work extension settings."
      }
    ]
  }
}
